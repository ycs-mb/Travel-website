# Travel Photo Organization Workflow Configuration

# Input/Output Settings
paths:
  input_images: "./sample_images"
  output_dir: "./output"
  metadata_output: "./output/metadata"
  reports_output: "./output/reports"
  website_output: "./output/website"
  logs_output: "./output/logs"

# Agent Configuration
agents:
  metadata_extraction:
    enabled: true
    parallel_workers: 4
    timeout_seconds: 30

  quality_assessment:
    enabled: true
    batch_size: 10
    model: "clip-iqa"  # Options: clip-iqa, gpt4v
    parallel_workers: 2

  aesthetic_assessment:
    enabled: true
    batch_size: 5
    parallel_workers: 2

  filtering_categorization:
    enabled: true
    min_technical_score: 3
    min_aesthetic_score: 3
    batch_size: 10

  caption_generation:
    enabled: true
    batch_size: 5
    include_keywords: true
    skip_rejected: true  # Skip caption generation for rejected images

# Cost Tracking
cost_tracking:
  enabled: true
  log_per_image: true           # Log token cost for each image
  display_in_reports: true      # Show costs in JSON reports
  display_in_ui: true           # Show costs in web UI
  alert_threshold_usd: 1.0      # Warn if batch exceeds this cost

# API Configuration (use environment variables for keys)
api:
  openai:
    model: "gpt-4-vision-preview"
    max_tokens: 4096
    temperature: 0.7

  google:
    model: "gemini-2.0-flash-lite"
    project: "gcloud-photo-project"  # Replace with your GCP project ID
    location: "us-central1"
    max_tokens: 2048
    temperature: 0.7

    # Token optimization settings
    pricing:
      input_per_1k_tokens: 0.000075   # $0.075 per 1M input tokens
      output_per_1k_tokens: 0.0003    # $0.30 per 1M output tokens

    optimization:
      enable_image_resizing: true      # Resize images to reduce token usage
      max_image_dimension: 1024        # Max width/height in pixels
      jpeg_quality: 85                 # Quality for resized images (1-100)
      use_concise_prompts: true        # Use shorter, optimized prompts
      skip_captions_for_rejected: true # Don't caption rejected images

# Quality Thresholds
thresholds:
  min_technical_quality: 3
  min_aesthetic_quality: 3
  min_resolution_pixels: 2000000  # 2MP
  max_noise_threshold: 0.15
  min_sharpness_variance: 100

# Error Handling
error_handling:
  max_retries: 3
  retry_delay_seconds: 2
  continue_on_error: true
  severity_levels: ["info", "warning", "error", "critical"]

# Logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "json"
  console_output: true
  file_output: true

# Parallelization
parallelization:
  enable_parallel_agents: true
  max_workers: 4
  parallel_groups:
    - ["quality_assessment", "aesthetic_assessment"]
    - ["filtering_categorization", "caption_generation"]
  # Optimized flow: Agents 1 → (2+3 parallel) → (4+5 parallel)

# Performance
performance:
  cache_embeddings: true
  cache_dir: "./cache"
  image_preview_size: [800, 800]
  thumbnail_size: [200, 200]

# Reverse Geocoding
reverse_geocoding:
  enabled: true
  provider: "nominatim"  # OpenStreetMap Nominatim (free)
  cache_enabled: true
  cache_ttl_hours: 168  # 7 days
  timeout_seconds: 5
  user_agent: "TravelPhotoAnalysis/1.0"
